{% extends "dashboard/base_dashboard.html" %}

{% block title %}Appointments{% endblock %}
{% block page_class %}appointments-page{% endblock %}

{% block content %}

      <!-- Search -->
      <!-- Appointments Search (same structure as patients) -->
      <section class="appointments-search">
        <form method="get" class="appointments-search-form" action="{% url 'appointments' %}">
          <div class="appointments-search-inputs">
            <input
              type="text"
              name="q"
              placeholder="Search by patient name..."
              value="{{ request.GET.q|default:'' }}"
              class="appointments-search-field"
              autocomplete="off"
            />
            <button type="submit" class="appointments-search-btn">Search</button>
          </div>
        </form>
      </section>

      <section class="appointments-list-section">
        <div class="section-header">
          <h3><i class="fa-solid fa-calendar-check"></i> Appointments</h3>
          <a href="#" class="btn-view-all">Add New</a>
        </div>

        <div class="appointments-table-wrapper">
          <table class="appointments-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>Patient</th>
                <th>Phone</th>
                <th>Date</th>
                <th>Status</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for appt in appointments %}
              <tr>
                <td>{{ appt.id }}</td>
                <td>{{ appt.patient.name }}</td>
                <td>{{ appt.patient.phone }}</td>
                <td>{{ appt.date }}</td>
                <td><span class="status {{ appt.status|lower }}">{{ appt.status }}</span></td>
                <td>
                  <a href="#" class="btn-action view">View</a>
                  <a href="#" class="btn-action update">Update</a>
                  <a href="#" class="btn-action delete">Delete</a>
                </td>
              </tr>
              {% empty %}
              <tr><td colspan="6">No appointments found.</td></tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="appointments-pagination">
          <ul class="pagination-list">
            {% if appointments.has_previous %}
              <li><a href="?page={{ appointments.previous_page_number }}{% if query %}&q={{ query }}{% endif %}">&laquo; Prev</a></li>
            {% else %}
              <li class="disabled">&laquo; Prev</li>
            {% endif %}

            {% for num in appointments.paginator.page_range %}
              {% if appointments.number == num %}
                <li class="active-page">{{ num }}</li>
              {% else %}
                <li><a href="?page={{ num }}{% if query %}&q={{ query }}{% endif %}">{{ num }}</a></li>
              {% endif %}
            {% endfor %}

            {% if appointments.has_next %}
              <li><a href="?page={{ appointments.next_page_number }}{% if query %}&q={{ query }}{% endif %}">Next &raquo;</a></li>
            {% else %}
              <li class="disabled">Next &raquo;</li>
            {% endif %}
          </ul>
        </div>
      </section>
{% endblock %}

